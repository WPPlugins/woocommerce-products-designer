(function(b){var a=function(){var U={},d,P=65,u,R='<div class="wpc-colorpicker"><div class="wpc-colorpicker_color"><div><div></div></div></div><div class="wpc-colorpicker_hue"><div></div></div><div class="wpc-colorpicker_new_color"></div><div class="wpc-colorpicker_current_color"></div><div class="wpc-colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="wpc-colorpicker_rgb_r wpc-colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="wpc-colorpicker_rgb_g wpc-colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="wpc-colorpicker_rgb_b wpc-colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="wpc-colorpicker_hsb_h wpc-colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="wpc-colorpicker_hsb_s wpc-colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="wpc-colorpicker_hsb_b wpc-colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="wpc-colorpicker_submit"></div></div>',D={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:true,flat:false},L=function(V,X){var W=k(V);b(X).data("wpc-colorpicker").fields.eq(1).val(W.r).end().eq(2).val(W.g).end().eq(3).val(W.b).end()},v=function(V,W){b(W).data("wpc-colorpicker").fields.eq(4).val(V.h).end().eq(5).val(V.s).end().eq(6).val(V.b).end()},h=function(V,W){b(W).data("wpc-colorpicker").fields.eq(0).val(T(V)).end()},m=function(V,W){b(W).data("wpc-colorpicker").selector.css("backgroundColor","#"+T({h:V.h,s:100,b:100}));b(W).data("wpc-colorpicker").selectorIndic.css({left:parseInt(150*V.s/100,10),top:parseInt(150*(100-V.b)/100,10)})},I=function(V,W){b(W).data("wpc-colorpicker").hue.css("top",parseInt(150-150*V.h/360,10))},i=function(V,W){b(W).data("wpc-colorpicker").currentColor.css("backgroundColor","#"+T(V))},G=function(V,W){b(W).data("wpc-colorpicker").newColor.css("backgroundColor","#"+T(V))},o=function(V){var X=V.charCode||V.keyCode||-1;if((X>P&&X<=90)||X==32){return false}var W=b(this).parent().parent();if(W.data("wpc-colorpicker").livePreview===true){f.apply(this)}},f=function(W){var X=b(this).parent().parent(),V;if(this.parentNode.className.indexOf("_hex")>0){X.data("wpc-colorpicker").color=V=n(A(this.value))}else{if(this.parentNode.className.indexOf("_hsb")>0){X.data("wpc-colorpicker").color=V=g({h:parseInt(X.data("wpc-colorpicker").fields.eq(4).val(),10),s:parseInt(X.data("wpc-colorpicker").fields.eq(5).val(),10),b:parseInt(X.data("wpc-colorpicker").fields.eq(6).val(),10)})}else{X.data("wpc-colorpicker").color=V=j(N({r:parseInt(X.data("wpc-colorpicker").fields.eq(1).val(),10),g:parseInt(X.data("wpc-colorpicker").fields.eq(2).val(),10),b:parseInt(X.data("wpc-colorpicker").fields.eq(3).val(),10)}))}}if(W){L(V,X.get(0));h(V,X.get(0));v(V,X.get(0))}m(V,X.get(0));I(V,X.get(0));G(V,X.get(0));X.data("wpc-colorpicker").onChange.apply(X,[V,T(V),k(V)])},p=function(V){var W=b(this).parent().parent();W.data("wpc-colorpicker").fields.parent().removeClass("wpc-colorpicker_focus")},M=function(){P=this.parentNode.className.indexOf("_hex")>0?70:65;b(this).parent().parent().data("wpc-colorpicker").fields.parent().removeClass("wpc-colorpicker_focus");b(this).parent().addClass("wpc-colorpicker_focus")},K=function(V){var X=b(this).parent().find("input").focus();var W={el:b(this).parent().addClass("wpc-colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:(this.parentNode.className.indexOf("_hsb")>0?100:255),y:V.pageY,field:X,val:parseInt(X.val(),10),preview:b(this).parent().parent().data("wpc-colorpicker").livePreview};b(document).bind("mouseup",W,t);b(document).bind("mousemove",W,O)},O=function(V){V.data.field.val(Math.max(0,Math.min(V.data.max,parseInt(V.data.val+V.pageY-V.data.y,10))));if(V.data.preview){f.apply(V.data.field.get(0),[true])}return false},t=function(V){f.apply(V.data.field.get(0),[true]);V.data.el.removeClass("wpc-colorpicker_slider").find("input").focus();b(document).unbind("mouseup",t);b(document).unbind("mousemove",O);return false},x=function(V){V.preventDefault();var X=V;if(typeof(event)!=="undefined"&&event.touches){X=event.touches[0]}var W={cal:b(this).parent(),y:b(this).offset().top};W.preview=W.cal.data("wpc-colorpicker").livePreview;b(document).bind("mouseup touchend",W,s);b(document).bind("mousemove touchmove",W,l);c(X,W,W.preview);return false},c=function(V,W,X){f.apply(W.cal.data("wpc-colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,V.pageY-W.y)))/150,10)).get(0),[X])},l=function(V){var W=V;if(typeof(event)!=="undefined"&&event.touches){W=event.touches[0]}c(W,V.data,V.data.preview);return false},s=function(V){L(V.data.cal.data("wpc-colorpicker").color,V.data.cal.get(0));h(V.data.cal.data("wpc-colorpicker").color,V.data.cal.get(0));b(document).unbind("mouseup touchend",s);b(document).unbind("mousemove touchmove",l);return false},z=function(V){V.preventDefault();var W={cal:b(this).parent(),pos:b(this).offset()};W.preview=W.cal.data("wpc-colorpicker").livePreview;b(document).bind("mouseup touchend",W,C);b(document).bind("mousemove touchmove",W,r);b(".wpc-colorpicker_color",W.cal).one("click",W,r);V.data=W;r(V)},r=function(V){var W=V;if(typeof(event)!=="undefined"&&event.touches){W=event.touches[0]}f.apply(V.data.cal.data("wpc-colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,(W.pageY-V.data.pos.top))))/150,10)).end().eq(5).val(parseInt(100*(Math.max(0,Math.min(150,(W.pageX-V.data.pos.left))))/150,10)).get(0),[V.data.preview]);return false},C=function(V){L(V.data.cal.data("wpc-colorpicker").color,V.data.cal.get(0));h(V.data.cal.data("wpc-colorpicker").color,V.data.cal.get(0));b(document).unbind("mouseup touchend",C);b(document).unbind("mousemove touchmove",r);return false},w=function(V){b(this).addClass("wpc-colorpicker_focus")},S=function(V){b(this).removeClass("wpc-colorpicker_focus")},q=function(W){var X=b(this).parent();var V=X.data("wpc-colorpicker").color;X.data("wpc-colorpicker").origColor=V;i(V,X.get(0));X.data("wpc-colorpicker").onSubmit(V,T(V),k(V),X.data("wpc-colorpicker").el)},y=function(W){var X=b("body"),Y=X.data("wpc-colorpickerId"),V=b(this).data("wpc-colorpickerId");if(Y&&Y===V){b(document).trigger("mousedown");X.data("wpc-colorpickerId",null)}else{F.call(this,W);X.data("wpc-colorpickerId",V)}},F=function(V){var Z=b("#"+b(this).data("wpc-colorpickerId"));Z.data("wpc-colorpicker").onBeforeShow.apply(this,[Z.get(0)]);var aa=b(this).offset();var Y=B();var X=aa.top+this.offsetHeight;var W=aa.left;if(X+176>Y.t+Y.h){X-=this.offsetHeight+176}if(W+356>Y.l+Y.w){W=Math.max(0,W-356)}Z.css({left:W+"px",top:X+"px"});if(Z.data("wpc-colorpicker").onShow.apply(this,[Z.get(0)])!=false){Z.show()}b(document).bind("mousedown",{cal:Z},Q);return false},Q=function(V){if(!J(V.data.cal.get(0),V.target,V.data.cal.get(0))){if(V.data.cal.data("wpc-colorpicker").onHide.apply(this,[V.data.cal.get(0)])!=false){V.data.cal.hide()}if(!J(b(V.data.cal[0]).data("wpc-colorpicker")["el"],V.target)){b("body").data("wpc-colorpickerId",null)}b(document).unbind("mousedown",Q)}},J=function(X,W,V){if(X==W){return true}if(X.contains){return X.contains(W)}if(X.compareDocumentPosition){return !!(X.compareDocumentPosition(W)&16)}var Y=W.parentNode;while(Y&&Y!=V){if(Y==X){return true}Y=Y.parentNode}return false},B=function(){var V=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(V?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(V?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(V?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(V?document.documentElement.clientHeight:document.body.clientHeight)}},g=function(V){return{h:Math.round(Math.min(360,Math.max(0,V.h))),s:Math.round(Math.min(100,Math.max(0,V.s))),b:Math.round(Math.min(100,Math.max(0,V.b)))}},N=function(V){return{r:Math.min(255,Math.max(0,V.r)),g:Math.min(255,Math.max(0,V.g)),b:Math.min(255,Math.max(0,V.b))}},A=function(X){var V=6-X.length;if(V>0){var Y=[];for(var W=0;W<V;W++){Y.push("0")}Y.push(X);X=Y.join("")}return X},e=function(V){var V=parseInt(((V.indexOf("#")>-1)?V.substring(1):V),16);return{r:V>>16,g:(V&65280)>>8,b:(V&255)}},n=function(V){return j(e(V))},j=function(X){var W={h:0,s:0,b:0};var Y=Math.min(X.r,X.g,X.b);var V=Math.max(X.r,X.g,X.b);var Z=V-Y;W.b=V;if(V!=0){}W.s=V!=0?255*Z/V:0;if(W.s!=0){if(X.r==V){W.h=(X.g-X.b)/Z}else{if(X.g==V){W.h=2+(X.b-X.r)/Z}else{W.h=4+(X.r-X.g)/Z}}}else{W.h=-1}W.h*=60;if(W.h<0){W.h+=360}W.s*=100/255;W.b*=100/255;W.h=Math.round(W.h);W.s=Math.round(W.s);W.b=Math.round(W.b);return W},k=function(V){var X={};var ab=Math.round(V.h);var aa=Math.round(V.s*255/100);var W=Math.round(V.b*255/100);if(aa==0){X.r=X.g=X.b=W}else{var ac=W;var Z=(255-aa)*W/255;var Y=(ac-Z)*(ab%60)/60;if(ab==360){ab=0}if(ab<60){X.r=ac;X.b=Z;X.g=Z+Y}else{if(ab<120){X.g=ac;X.b=Z;X.r=ac-Y}else{if(ab<180){X.g=ac;X.r=Z;X.b=Z+Y}else{if(ab<240){X.b=ac;X.r=Z;X.g=ac-Y}else{if(ab<300){X.b=ac;X.g=Z;X.r=Z+Y}else{if(ab<360){X.r=ac;X.g=Z;X.b=ac-Y}else{X.r=0;X.g=0;X.b=0}}}}}}}return{r:Math.round(X.r),g:Math.round(X.g),b:Math.round(X.b)}},E=function(V){var W=[V.r.toString(16),V.g.toString(16),V.b.toString(16)];b.each(W,function(X,Y){if(Y.length==1){W[X]="0"+Y}});return W.join("")},T=function(V){return E(k(V))},H=function(){var W=b(this).parent();var V=W.data("wpc-colorpicker").origColor;W.data("wpc-colorpicker").color=V;L(V,W.get(0));h(V,W.get(0));v(V,W.get(0));m(V,W.get(0));I(V,W.get(0));G(V,W.get(0))};return{init:function(V){V=b.extend({},D,V||{});if(typeof V.color=="string"){V.color=n(V.color)}else{if(V.color.r!=undefined&&V.color.g!=undefined&&V.color.b!=undefined){V.color=j(V.color)}else{if(V.color.h!=undefined&&V.color.s!=undefined&&V.color.b!=undefined){V.color=g(V.color)}else{return this}}}return this.each(function(){if(!b(this).data("wpc-colorpickerId")){var W=b.extend({},V);W.origColor=V.color;var Y="wpc-colorpicker_"+(b(this).attr("id")||parseInt(Math.random()*1000));b(this).data("wpc-colorpickerId",Y);var X=b(R).attr("id",Y);if(W.flat){X.appendTo(this).show()}else{X.appendTo(document.body)}W.fields=X.find("input").bind("keyup",o).bind("change",f).bind("blur",p).bind("focus",M);X.find("span").bind("mousedown touchstart",K).end().find(">div.wpc-colorpicker_current_color").bind("click",H);W.selector=X.find("div.wpc-colorpicker_color").bind("touchstart mousedown",z);W.selectorIndic=W.selector.find("div div");W.el=this;W.hue=X.find("div.wpc-colorpicker_hue div");X.find("div.wpc-colorpicker_hue").bind("mousedown touchstart",x);W.newColor=X.find("div.wpc-colorpicker_new_color");W.currentColor=X.find("div.wpc-colorpicker_current_color");X.data("wpc-colorpicker",W);X.find("div.wpc-colorpicker_submit").bind("mouseenter touchstart",w).bind("mouseleave touchend",S).bind("click",q);L(W.color,X.get(0));v(W.color,X.get(0));h(W.color,X.get(0));I(W.color,X.get(0));m(W.color,X.get(0));i(W.color,X.get(0));G(W.color,X.get(0));if(W.flat){X.css({position:"relative",display:"block"})}else{b(this).bind(W.eventName,y)}}})},showPicker:function(){return this.each(function(){if(b(this).data("wpc-colorpickerId")){F.apply(this)}})},hidePicker:function(){return this.each(function(){if(b(this).data("wpc-colorpickerId")){b("#"+b(this).data("wpc-colorpickerId")).hide()}})},setColor:function(V){if(typeof V=="string"){V=n(V)}else{if(V.r!=undefined&&V.g!=undefined&&V.b!=undefined){V=j(V)}else{if(V.h!=undefined&&V.s!=undefined&&V.b!=undefined){V=g(V)}else{return this}}}return this.each(function(){if(b(this).data("wpc-colorpickerId")){var W=b("#"+b(this).data("wpc-colorpickerId"));W.data("wpc-colorpicker").color=V;W.data("wpc-colorpicker").origColor=V;L(V,W.get(0));v(V,W.get(0));h(V,W.get(0));I(V,W.get(0));m(V,W.get(0));i(V,W.get(0));G(V,W.get(0))}})}}}();b.fn.extend({ColorPicker:a.init,ColorPickerHide:a.hidePicker,ColorPickerShow:a.showPicker,ColorPickerSetColor:a.setColor})})(jQuery);